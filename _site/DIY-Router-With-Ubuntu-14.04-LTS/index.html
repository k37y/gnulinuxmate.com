<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>DIY Router With Ubuntu 14.04 LTS &#8211; linuxmate</title> <meta name="description" content="I have been using Ubuntu as my base machine for the past some years. Things have been learning from day to day since then. Recently, my thoughts have crossed the internals of routers and which turned out to be the idea of Ubuntu as a router. You would be wondering why do we need Ubuntu as a router when we have ready-made one? Assume that, we are living in a town like Mumbai where ISP provide DSL connections to the whole apartment through a switch installed on the top of it. In that case, we don’t have to pay for router or something when we get connected like plugged in directly to the PC or laptop. This scenario makes to think “Linux as a router” if you love and explore the possibilities of Linux. All we have to need is two LAN card or in my case, second one is WLAN as a Wireless Access Point. Wireless Access Point provide internet as well as IP address from the configured DHCP server which I have installed in my machine. Following are the needful."> <meta name="keywords" content=""> <!-- Twitter Cards --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:image" content="http://localhost:4000//img/router.png"> <meta name="twitter:title" content="DIY Router With Ubuntu 14.04 LTS"> <meta name="twitter:description" content="I have been using Ubuntu as my base machine for the past some years. Things have been learning from day to day since then. Recently, my thoughts have crossed the internals of routers and which turned out to be the idea of Ubuntu as a router. You would be wondering why do we need Ubuntu as a router when we have ready-made one? Assume that, we are living in a town like Mumbai where ISP provide DSL connections to the whole apartment through a switch installed on the top of it. In that case, we don’t have to pay for router or something when we get connected like plugged in directly to the PC or laptop. This scenario makes to think “Linux as a router” if you love and explore the possibilities of Linux. All we have to need is two LAN card or in my case, second one is WLAN as a Wireless Access Point. Wireless Access Point provide internet as well as IP address from the configured DHCP server which I have installed in my machine. Following are the needful."> <meta name="twitter:site" content="@kevy_vinu"> <meta name="twitter:creator" content="@kevy_vinu"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="DIY Router With Ubuntu 14.04 LTS"> <meta property="og:description" content="I have been using Ubuntu as my base machine for the past some years. Things have been learning from day to day since then. Recently, my thoughts have crossed the internals of routers and which turned out to be the idea of Ubuntu as a router. You would be wondering why do we need Ubuntu as a router when we have ready-made one? Assume that, we are living in a town like Mumbai where ISP provide DSL connections to the whole apartment through a switch installed on the top of it. In that case, we don’t have to pay for router or something when we get connected like plugged in directly to the PC or laptop. This scenario makes to think “Linux as a router” if you love and explore the possibilities of Linux. All we have to need is two LAN card or in my case, second one is WLAN as a Wireless Access Point. Wireless Access Point provide internet as well as IP address from the configured DHCP server which I have installed in my machine. Following are the needful."> <meta property="og:url" content="http://localhost:4000/DIY-Router-With-Ubuntu-14.04-LTS/"> <meta property="og:site_name" content="linuxmate"> <meta property="og:image" content="http://localhost:4000/images/halve.png"> <link rel="canonical" href="http://localhost:4000/DIY-Router-With-Ubuntu-14.04-LTS/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000//img/router.png) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/posts.jpg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(http://localhost:4000/images/home.png) no-repeat;background-size: cover;} </style> </head> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <a href="http://localhost:4000" class="logo"><img src="http://localhost:4000/images/halve.png"></a> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">DIY Router With Ubuntu 14.04 LTS </h1> <ul class="tags"> </ul> <div class="section-line reverse"><a href="http://localhost:4000/posts">Back to posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <div class="share-buttons"> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/DIY-Router-With-Ubuntu-14.04-LTS/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/DIY-Router-With-Ubuntu-14.04-LTS/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> </div> <a href="../posts.html" title="posts" class="posts-menu-icon"></a> <a href="/portfolio" title="portfolio" class="projects-menu-icon"> <span></span> </a> <div class="inner-post content"> <div class="date-highlight">18 Jun 2017</div> <p>I have been using Ubuntu as my base machine for the past some years. Things have been learning from day to day since then. Recently, my thoughts have crossed the internals of routers and which turned out to be the idea of Ubuntu as a router. You would be wondering why do we need Ubuntu as a router when we have ready-made one? Assume that, we are living in a town like Mumbai where ISP provide DSL connections to the whole apartment through a switch installed on the top of it. In that case, we don’t have to pay for router or something when we get connected like plugged in directly to the PC or laptop. This scenario makes to think “Linux as a router” if you love and explore the possibilities of Linux. All we have to need is two LAN card or in my case, second one is WLAN as a Wireless Access Point. Wireless Access Point provide internet as well as IP address from the configured DHCP server which I have installed in my machine. Following are the needful.</p> <ul> <li>DHCP Server</li> <li>Hostapd</li> <li>IPtable Configuration</li> <li>Switch Linux as Router</li> <li>Configure Network</li> </ul> <h3 id="dhcp-server">DHCP Server</h3> <blockquote> <p>sudo apt-get install dnsmasq</p> </blockquote> <blockquote> <p>sudo vim /etc/dnsmasq.conf</p> </blockquote> <div class="highlighter-rouge"><pre class="highlight"><code><span class="nv">interface</span><span class="o">=</span>wlan0
dhcp-range<span class="o">=</span>10.0.0.2,10.0.0.14,12h
</code></pre></div> <h3 id="hostapd">Hostapd</h3> <blockquote> <p>sudo apt-get install hostapd</p> </blockquote> <blockquote> <p>sudo vim /etc/default/hostapd.conf</p> </blockquote> <div class="highlighter-rouge"><pre class="highlight"><code><span class="nv">DAEMON_CONF</span><span class="o">=</span><span class="s2">"/etc/hostapd/hostapd.conf"</span>
</code></pre></div> <blockquote> <p>sudo nano /etc/hostapd/hostapd.conf</p> </blockquote> <div class="highlighter-rouge"><pre class="highlight"><code><span class="nv">auth_algs</span><span class="o">=</span>1
<span class="nv">beacon_int</span><span class="o">=</span>50
<span class="nv">channel</span><span class="o">=</span>3
<span class="nv">country_code</span><span class="o">=</span>US
<span class="nv">disassoc_low_ack</span><span class="o">=</span>1
<span class="nv">driver</span><span class="o">=</span>nl80211
<span class="nv">hw_mode</span><span class="o">=</span>g
<span class="nv">ht_capab</span><span class="o">=[</span>HT40+][HT40-][SHORT-GI-40][RX-STBC1]
<span class="nv">ieee80211d</span><span class="o">=</span>1
<span class="nv">ieee80211n</span><span class="o">=</span>1
<span class="nv">interface</span><span class="o">=</span>wlan0
<span class="nv">require_ht</span><span class="o">=</span>0
<span class="nv">rsn_pairwise</span><span class="o">=</span>CCMP
<span class="nv">ssid</span><span class="o">=</span>YOURSSID
<span class="nv">wmm_enabled</span><span class="o">=</span>1
<span class="nv">wpa</span><span class="o">=</span>2
<span class="nv">wpa_key_mgmt</span><span class="o">=</span>WPA-PSK
<span class="nv">wpa_passphrase</span><span class="o">=</span>YOURPASSPHASE
</code></pre></div> <h3 id="iptables">IPtables</h3> <blockquote> <p>sudo nano /etc/rc.local</p> </blockquote> <div class="highlighter-rouge"><pre class="highlight"><code>iptables -t nat -A POSTROUTING <span class="se">\</span>
-o wlan1 -j MASQUERADE
iptables -A FORWARD -m conntrack <span class="se">\</span>
--ctstate RELATED,ESTABLISHED -j ACCEPT
iptables -A FORWARD <span class="se">\</span>
-i wlan0 -o wlan1 -j ACCEPT
<span class="nb">exit </span>0
</code></pre></div> <h3 id="switch-linux-as-router">Switch Linux as router</h3> <blockquote> <p>sudo nano /etc/sysctl.conf</p> </blockquote> <div class="highlighter-rouge"><pre class="highlight"><code>net.ipv4.ip_forward<span class="o">=</span>1
net.ipv6.conf.all.forwarding<span class="o">=</span>1
</code></pre></div> <h3 id="configure-network">Configure Network</h3> <blockquote> <p>sudo nano /etc/network/interfaces</p> </blockquote> <div class="highlighter-rouge"><pre class="highlight"><code>auto lo wlan0
iface lo inet loopback
<span class="c">#access point</span>
iface wlan0 inet static
address 10.0.0.1
netmask 255.255.255.240
gateway 10.0.0.1
dns-nameservers 192.168.1.1
wireless-mode Master
</code></pre></div> <blockquote> <p>sudo nano /etc/NetworkManager/NetworkManager.conf</p> </blockquote> <div class="highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>keyfile]
unmanaged-devices<span class="o">=</span>mac:XX:XX:XX:XX:XX:XX
</code></pre></div> <br> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/DIY-Router-With-Ubuntu-14.04-LTS/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/DIY-Router-With-Ubuntu-14.04-LTS/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <nav class="pagination"> <a href="http://localhost:4000/Linux-Magazines-Download-Script/" class="pagination_pager" title="Linux Magazine Download Script ">previous</a> <a href="http://localhost:4000/Install-GRUB-on-USB-drive/" class="pagination_pager" title="Install GRUB On USB Drive ">next</a> </nav> <br> <br> <div class="comments"> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'linuxmate-ml'; /* ensure that pages with query string get the same discussion */ var url_parts = window.location.href.split("?"); var disqus_url = url_parts[0]; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> </div> </div> <!-- JS --> <script src="http://localhost:4000/assets/js/main.min.js"></script> </body> </html>
